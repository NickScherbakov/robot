# üìä Model Optimizer - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞—Ç—Ä–∞—Ç –Ω–∞ AI –º–æ–¥–µ–ª–∏

## –û–±–∑–æ—Ä

Model Optimizer - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AI –º–æ–¥–µ–ª–µ–π, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π Google Cloud Vertex AI Model Optimizer. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞—Ç—Ä–∞—Ç—ã –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –±–æ–ª–µ–µ —ç–∫–æ–Ω–æ–º–∏—á–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üéØ –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∫ AI –º–æ–¥–µ–ª—è–º –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ü–µ–Ω** - –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã –Ω–∞ 15+ –º–æ–¥–µ–ª–µ–π –æ—Ç —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- **–ê–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –±–æ–ª–µ–µ –¥–µ—à–µ–≤—ã—Ö –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤
- **–î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–æ–¥–µ–ª—è–º, –∑–∞–¥–∞—á–∞–º, –∑–∞—Ç—Ä–∞—Ç–∞–º
- **REST API** - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ HTTP API
- **CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–æ–º

### üí∞ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

1. **OpenAI** - GPT-4o, GPT-4o-mini, GPT-4-turbo, GPT-3.5-turbo
2. **Anthropic** - Claude 3 Opus, Sonnet, Haiku
3. **Mistral AI** - Large, Medium, Small
4. **Google** - Gemini 1.5 Pro, Flash
5. **DeepSeek** - Chat, Coder
6. **OpenRouter** - –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä –º–æ–¥–µ–ª–µ–π

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

Model Optimizer –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –ø—Ä–æ–µ–∫—Ç:

```bash
# –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ –≤ requirements.txt
pip install -r requirements.txt

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
python -m backend.model_optimizer
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Middleware

```python
from backend.optimizer_middleware import track_usage

@track_usage("openai", "gpt-4o", "content_generation")
def generate_content(prompt):
    response = openai_client.chat.completions.create(
        model="gpt-4o",
        messages=[{"role": "user", "content": prompt}]
    )
    return response
```

### 2. –†—É—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
from backend.optimizer_middleware import track_manual

track_manual(
    provider="anthropic",
    model="claude-3-opus-20240229",
    task_type="content_generation",
    input_tokens=500,
    output_tokens=300,
    latency_ms=1500,
    success=True,
    quality_rating=9.5
)
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏

```python
from backend.optimizer_middleware import get_optimal_provider

provider, model = get_optimal_provider(
    task_type="content_generation",
    required_capabilities=["text", "vision"],
    max_cost=0.01  # –º–∞–∫—Å–∏–º—É–º $0.01 –∑–∞ –∑–∞–ø—Ä–æ—Å
)

print(f"–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: {provider}/{model}")
```

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ API

#### –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

```bash
curl http://localhost:5000/api/optimizer/stats?days=30
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "period_days": 30,
    "total_cost_usd": 15.42,
    "total_requests": 1234,
    "average_cost_per_request": 0.0125,
    "by_model": [
      {
        "model": "openai/gpt-4o",
        "requests": 500,
        "cost_usd": 12.50,
        "avg_latency_ms": 2300,
        "avg_quality": 9.1
      }
    ]
  }
}
```

#### –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

```bash
curl http://localhost:5000/api/optimizer/recommendations?days=30
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "count": 2,
  "total_potential_savings_monthly": 45.60,
  "recommendations": [
    {
      "current_model": "openai/gpt-4o",
      "recommended_model": "anthropic/claude-3-haiku-20240307",
      "estimated_savings_percent": 75.0,
      "estimated_savings_usd_monthly": 37.50,
      "quality_impact": "minimal",
      "reason": "–ú–æ–¥–µ–ª—å anthropic/claude-3-haiku-20240307 –¥–µ—à–µ–≤–ª–µ –Ω–∞ 75.0% –ø—Ä–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–º –∫–∞—á–µ—Å—Ç–≤–µ",
      "confidence": 0.8
    }
  ]
}
```

#### –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç

```bash
curl http://localhost:5000/api/optimizer/report?days=30&format=markdown
```

#### –ù–∞–π—Ç–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å

```bash
curl -X POST http://localhost:5000/api/optimizer/optimal-model \
  -H "Content-Type: application/json" \
  -d '{
    "task_type": "content_generation",
    "max_cost_per_request": 0.01,
    "required_capabilities": ["text", "code"]
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "provider": "mistral",
  "model": "mistral-small-latest",
  "estimated_cost_per_request": 0.008,
  "full_model_name": "mistral/mistral-small-latest"
}
```

#### –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞

```bash
curl -X POST http://localhost:5000/api/optimizer/cost-calculator \
  -H "Content-Type: application/json" \
  -d '{
    "provider": "openai",
    "model": "gpt-4o",
    "input_tokens": 1500,
    "output_tokens": 800
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "provider": "openai",
  "model": "gpt-4o",
  "input_tokens": 1500,
  "output_tokens": 800,
  "cost_usd": 0.01175,
  "cost_per_1k_tokens": 0.00511
}
```

#### –ü–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—ã –Ω–∞ –≤—Å–µ –º–æ–¥–µ–ª–∏

```bash
curl http://localhost:5000/api/optimizer/pricing?min_quality=80&max_price=10
```

### 5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ CLI

```bash
# –ó–∞–ø—É—Å–∫ CLI
python cli.py

# –í –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ:
# 7 - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Model Optimizer
# 8 - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
# 9 - –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:**

```
üí° Found 2 optimization opportunities
üí∞ Total Potential Savings: $45.60/month

1. openai/gpt-4o ‚Üí anthropic/claude-3-haiku-20240307
   Savings: 75.0% ($37.50/mo)
   Quality Impact: minimal
   Reason: –ú–æ–¥–µ–ª—å anthropic/claude-3-haiku-20240307 –¥–µ—à–µ–≤–ª–µ –Ω–∞ 75.0% –ø—Ä–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–º –∫–∞—á–µ—Å—Ç–≤–µ
   Confidence: 80%

2. anthropic/claude-3-opus-20240229 ‚Üí openai/gpt-4o-mini
   Savings: 92.0% ($8.10/mo)
   Quality Impact: moderate
   Reason: –ú–æ–¥–µ–ª—å openai/gpt-4o-mini –¥–µ—à–µ–≤–ª–µ –Ω–∞ 92.0% –ø—Ä–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–º –∫–∞—á–µ—Å—Ç–≤–µ
   Confidence: 60%
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```
backend/
‚îú‚îÄ‚îÄ model_optimizer.py        # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞
‚îú‚îÄ‚îÄ optimizer_api.py          # REST API endpoints
‚îî‚îÄ‚îÄ optimizer_middleware.py   # Middleware –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**–¢–∞–±–ª–∏—Ü—ã:**

1. **model_pricing** - —Ü–µ–Ω—ã –Ω–∞ –º–æ–¥–µ–ª–∏
   - provider, model, input_price_per_1m, output_price_per_1m
   - context_window, capabilities, quality_score, speed_score

2. **usage_records** - –∑–∞–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - timestamp, provider, model, task_type
   - input_tokens, output_tokens, cost_usd
   - latency_ms, success, quality_rating

3. **recommendations** - –∏—Å—Ç–æ—Ä–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
   - current_model, recommended_model
   - estimated_savings_percent, quality_impact
   - applied (–ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è)

### –ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
2. **–ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** - –≤—ã—è–≤–ª–µ–Ω–∏–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –º–æ–¥–µ–ª–µ–π
3. **–ü–æ–∏—Å–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤** - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ –ø–æ:
   - –¶–µ–Ω–µ (–æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä)
   - –ö–∞—á–µ—Å—Ç–≤—É (–¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–Ω–∏–∂–µ–Ω–∏–µ –¥–æ 10 –±–∞–ª–ª–æ–≤)
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º (–¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å)
4. **–û—Ü–µ–Ω–∫–∞ —ç–∫–æ–Ω–æ–º–∏–∏** - —Ä–∞—Å—á–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π —ç–∫–æ–Ω–æ–º–∏–∏
5. **–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —ç–∫–æ–Ω–æ–º–∏–∏

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# .env
OPTIMIZER_DB_PATH=data/optimizer.db
OPTIMIZER_ENABLED=true
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

–ü—Ä–∏ –ø–æ–∏—Å–∫–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∫–∞—á–µ—Å—Ç–≤–∞:

```python
optimizer = ModelOptimizer()

# –ò—Å–∫–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —Å –∫–∞—á–µ—Å—Ç–≤–æ–º –Ω–µ –Ω–∏–∂–µ 75
alternative = optimizer.get_cheapest_alternative(
    current_model="openai/gpt-4o",
    required_capabilities=["text"],
    min_quality_score=75
)
```

## –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### Quality Score (0-100)

–û—Ü–µ–Ω–∫–∞ –æ–±—â–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ:
- –¢–æ—á–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤
- –°–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
- –ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

**–ü—Ä–∏–º–µ—Ä—ã:**
- GPT-4o: 95
- Claude 3 Opus: 98
- GPT-4o-mini: 85
- Gemini Flash: 82

### Speed Score (0-100)

–û—Ü–µ–Ω–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏:
- Latency (–≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞)
- Throughput (—Ç–æ–∫–µ–Ω–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É)

**–ü—Ä–∏–º–µ—Ä—ã:**
- GPT-3.5-turbo: 98 (–æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è)
- Gemini Flash: 98
- GPT-4o: 85 (—Å—Ä–µ–¥–Ω—è—è)
- Claude 3 Opus: 65 (–º–µ–¥–ª–µ–Ω–Ω–∞—è)

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç

```python
from backend.model_optimizer import ModelOptimizer

optimizer = ModelOptimizer()

# –¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å: gpt-4o ($2.50 input + $10.00 output)
# –ó–∞–¥–∞—á–∞: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

# –ù–∞—Ö–æ–¥–∏–º –±–æ–ª–µ–µ –¥–µ—à–µ–≤—É—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É
provider, model = optimizer.get_optimal_model_for_task(
    task_type="content_generation",
    max_cost_per_request=0.005,  # –õ–∏–º–∏—Ç $0.005
    required_capabilities=["text"]
)

# –†–µ–∑—É–ª—å—Ç–∞—Ç: mistral/mistral-small-latest
# –≠–∫–æ–Ω–æ–º–∏—è: 80%
```

### –ü—Ä–∏–º–µ—Ä 2: –ê–Ω–∞–ª–∏–∑ –∑–∞—Ç—Ä–∞—Ç –∑–∞ –º–µ—Å—è—Ü

```python
stats = optimizer.get_usage_stats(30)

print(f"–ó–∞—Ç—Ä–∞—Ç—ã –∑–∞ –º–µ—Å—è—Ü: ${stats['total_cost_usd']:.2f}")
print(f"–í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤: {stats['total_requests']}")

# –¢–æ–ø-3 —Å–∞–º—ã—Ö –¥–æ—Ä–æ–≥–∏—Ö –º–æ–¥–µ–ª–µ–π
for model in stats['by_model'][:3]:
    print(f"{model['model']}: ${model['cost_usd']:.2f}")
```

### –ü—Ä–∏–º–µ—Ä 3: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç

```python
report = optimizer.generate_optimization_report(30)

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—á–µ—Ç –≤–ª–∞–¥–µ–ª—å—Ü—É
send_email(
    to="owner@example.com",
    subject="Monthly AI Optimization Report",
    body=report
)
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ scheduler:

```python
# backend/scheduler.py

from backend.model_optimizer import ModelOptimizer
from frontend.telegram_bot import send_message_to_owner

def generate_weekly_optimizer_report():
    """–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏"""
    optimizer = ModelOptimizer()
    report = optimizer.generate_optimization_report(7)
    send_message_to_owner(f"üìä Weekly Optimization Report:\n\n{report}")

# –î–æ–±–∞–≤–∏—Ç—å –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
schedule.every().monday.at("09:00").do(generate_weekly_optimizer_report)
```

## FAQ

### –ö–∞–∫ —á–∞—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ü–µ–Ω—ã?

–¶–µ–Ω—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–∞—Ä–∏—Ñ–æ–≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑ –≤ –º–µ—Å—è—Ü.

### –ú–æ–∂–Ω–æ –ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é –º–æ–¥–µ–ª—å?

–î–∞, —á–µ—Ä–µ–∑ API –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –≤ –±–∞–∑—É:

```python
from backend.model_optimizer import ModelOptimizer, ModelPricing
from datetime import datetime

optimizer = ModelOptimizer()

new_model = ModelPricing(
    provider="custom",
    model="my-model",
    input_price_per_1m=1.0,
    output_price_per_1m=2.0,
    context_window=8192,
    capabilities=["text"],
    quality_score=85,
    speed_score=90,
    last_updated=datetime.now().isoformat()
)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ SQL INSERT
```

### –ö–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å?

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ:
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite (–±—ã—Å—Ç—Ä–∞—è)
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –∑–∞–ø—Ä–æ—Å—É, –∞ –Ω–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –ú–æ–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä?

–î–∞, —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
export OPTIMIZER_ENABLED=false
```

## Roadmap

- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω —á–µ—Ä–µ–∑ API –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- [ ] ML-–º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `data/optimizer.db`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ OPTIMIZER_ENABLED=true
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É –ë–î

---

**–°–æ–∑–¥–∞–Ω:** 2025-12-29  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–õ–∏—Ü–µ–Ω–∑–∏—è:** MIT
